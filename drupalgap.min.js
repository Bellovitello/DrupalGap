/*! drupalgap 2016-01-16 */
function core_rest_preprocess(a,b){dg.spinnerShow()}function core_rest_post_process(a){dg.spinnerHide()}var dg={},drupalgap=dg;dg.activeTheme=null,dg.regions=null,dg.blocks=null,dg.spinner=0,dg.settings={mode:"web-app",front:null,blocks:{}},dg.start=function(){"phonegap"==dg.getMode()?document.addEventListener("deviceready",dg.deviceready,!1):dg.deviceready()},dg.deviceready=function(){return dg.bootstrap(),jDrupal.isReady()?void jDrupal.connect().then(this.devicereadyGood,this.devicereadyBad):void dg.alert("Set the sitePath in the settings.js file!")},dg.devicereadyGood=function(a){for(var b in a.drupalgap)a.drupalgap.hasOwnProperty(b)&&(drupalgap[b]=a.drupalgap[b]);dg.router.check(dg.router.getFragment())},dg.devicereadyBad=function(){var a="Failed connection to "+jDrupal.sitePath();""!=msg&&(a+=" - "+msg),dg.alert(a,{title:"Unable to Connect",alertCallback:function(){}})},dg.bootstrap=function(){dg.router.config({});var a=jDrupal.modulesLoad();for(var b in a)if(a.hasOwnProperty(b)&&a[b].routing){var c=a[b].routing();if(c)for(route in c)if(c.hasOwnProperty(route)){var d=c[route];dg.router.add(d)}}dg.themeLoad().then(function(){dg.blocksLoad();dg.router.add(function(){}).listen()})},dg.spinnerShow=function(){dg.spinner++,1==dg.spinner&&(document.getElementById("dgSpinner").style.display="block")},dg.spinnerHide=function(){dg.spinner--,dg.spinner||(document.getElementById("dgSpinner").style.display="none")},dg.FormElement=function(a,b,c){this.name=a,this.element=b,this.form=c},dg.FormElement.prototype.id=function(){return this.element?this.element._attributes.id:null},dg.FormElement.prototype.getForm=function(){return this.form},dg.FormElement.prototype.get=function(a){return this[a]},dg.FormElement.prototype.valueCallback=function(){var a=this;return new Promise(function(b,c){var d=null,e=document.getElementById(a.id());e&&(d=e.value),b({name:a.get("name"),value:d})})},dg.Block=function(a){this.format="div";for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},dg.Block.prototype.get=function(a){return"undefined"!=typeof this[a]?this[a]:null},dg.Block.prototype.set=function(a,b){this[a]=b},dg.Block.prototype.buildWrapper=function(){var a=this;return new Promise(function(b,c){a.build().then(function(c){a.set("content",c),b(a)})})},dg.Block.prototype.build=function(){return new Promise(function(a,b){a("")})},dg.blocksLoad=function(){if(dg.blocks)return dg.blocks;dg.blocks={};var a={},b=dg.config("theme").name,c=drupalgap.settings.blocks[b],d=0;for(var e in c)if(c.hasOwnProperty(e))for(var f in c[e])if(c[e].hasOwnProperty(f)){var g=c[e][f];g.region=e,a[f]=g,d++}if(0==d){var h='WARNING: No blocks were found for the "'+b+'" theme in settings.js';console.log(h)}var i=jDrupal.modulesLoad();for(var j in i)if(i.hasOwnProperty(j)&&i[j].blocks){var k=i[j].blocks();if(k)for(g in k)if(k.hasOwnProperty(g)&&a[g]){var l=k[g];if(l.id||(l.id=g),l.module||(l.module=j),l.attributes||(l.attributes={}),l.attributes.id||(l.attributes.id=g),dg.blocks[g]){var h='WARNING - The "'+g+'" block provided by the "'+dg.blocks[g].get("module")+'" module has been overwritten by the "'+l.module+'" module.';console.log(h)}dg.blocks[g]=new dg.Block(l);for(var m in a[g])a[g].hasOwnProperty(m)&&dg.blocks[g].set(m,a[g][m])}}return dg.blocks},dg.blockLoad=function(a){return dg.blocks[a]?dg.blocks[a]:null},dg.config=function(a){var b=arguments[1]?arguments[1]:null;return b?void(dg.settings[a]=b):dg.settings[a]},dg.getMode=function(){return this.config("mode")},dg.setMode=function(a){this.config("mode",a)},dg.attributes=function(a){var b="";if(a)for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];Array.isArray(d)&&d.length?b+=c+'="'+d.join(" ")+'" ':""!=d?b+=c+'="'+d+'" ':"class"!=c&&(b+=c+" ")}return b},dg.applyToConstructor=function(a,b){var c=[null].concat(b),d=a.bind.apply(a,c);return new d},dg.getCamelCase=function(a){return a.replace(/[-_]([a-z])/g,function(a){return a[1].toUpperCase()})},dg.killCamelCase=function(a,b){return jDrupal.lcfirst(a).replace(/([A-Z])/g,b+"$1").toLowerCase()},dg.Node=function(a){return new jDrupal.Node(a)},dg.entityRenderContent=function(a){return new Promise(function(b,c){var d=a.getEntityType(),e=a.getBundle(),f=a.getEntityKey("label"),g={};g[f]={_theme:"entity_label",_entity:a,_attributes:{"class":[d+"-title"]}};var h=e?dg.entity_view_mode[d][e]:dg.entity_view_mode[d];for(var i in h)if(h.hasOwnProperty(i)){var j=dg.fieldStorageConfig[d][i];if(j){var k=j.module,l=h[i].type;if(!jDrupal.moduleExists(k)){var m='WARNING - entityRenderContent - The "'+k+'" module is not present to render the "'+i+'" field.';console.log(m);continue}if(!dg.modules[k].FieldFormatter||!dg.modules[k].FieldFormatter[l]){console.log('WARNING - entityRenderContent - There is no "'+l+'" formatter in the "'+k+'" module to handle the "'+i+'" field.');continue}var n=new dg.FieldItemListInterface(a.get(i)),o=new dg.FieldDefinitionInterface(d,e,i),p=new dg.modules[k].FieldFormatter[l](o,h[i].settings,h[i].label,h[i],h[i].third_party_settings);g[i]=p.viewElements(n,a.language())}else console.log('WARNING - entityRenderContent - No field storage config for "'+i+'"')}jDrupal.moduleInvokeAll("entity_view",g,a).then(b(g))})},dg.theme_entity_label=function(a){return"<h2 "+dg.attributes(a._attributes)+">"+a._entity.label()+"</h2>"},dg.FieldDefinitionInterface=function(a,b,c){this.entityType=a,this.bundle=b,this.fieldName=c,this.fieldDefinition=dg.fieldDefinitions[a][b][c]},dg.FieldDefinitionInterface.prototype.get=function(a){return this.fieldDefinition[a]},dg.FieldDefinitionInterface.prototype.getLabel=function(){return this.get("label")},dg.FieldFormMode=function(a){this.fieldFormMode=a},dg.FieldFormatter=function(){this._fieldDefinition=null,this._settings=null,this._label=null,this._viewMode=null,this._thirdPartySettings=null},dg.FieldFormatterPrepare=function(a,b){this._fieldDefinition=b[0],this._settings=b[1],this._label=b[2],this._viewMode=b[3],this._thirdPartySettings=b[4]},dg.FieldFormatter.prototype.viewElements=function(a,b){var c=a.getItems(),d={};if(0==c.length)return d;for(var e=0;e<c.length;e++)d[e]={_markup:c[e].value};return d},dg.FieldItemListInterface=function(a){this._items=a},dg.FieldItemListInterface.prototype.getItems=function(){return this._items},dg.FieldWidget=function(a,b,c,d,e,f){},dg.FieldWidget.prototype=new dg.FormElement,dg.FieldWidget.prototype.constructor=dg.FieldWidget,dg.FieldWidgetPrepare=function(a,b){a.widgetType="FieldWidget",a.entityType=b[0],a.bundle=b[1],a.fieldName=b[2],a.name=a.fieldName,a.element=b[3],a.items=b[4],a.delta=b[5],a.fieldDefinition=new dg.FieldDefinitionInterface(a.entityType,a.bundle,a.fieldName),a.fieldFormMode=a.element._fieldFormMode},dg.FieldWidget.prototype.getSetting=function(a){return this.settings[a]},dg.FieldWidget.prototype.setSetting=function(a,b){this.settings[property]=b},dg.FieldWidget.prototype.getSettings=function(){return this.settings},dg.FieldWidget.prototype.setSettings=function(a){this.settings=a},dg.FieldWidget.prototype.valueCallback=function(){var a=this;return new Promise(function(b,c){var d=null,e=document.getElementById(a.id());e&&(d=e.value),b({name:a.get("name"),value:[{value:d}]})})},dg.theme_actions=function(a){var b="";for(prop in a)dg.isFormElement(prop,a)&&(b+=dg.render(a[prop]));return b},dg.theme_hidden=function(a){return a._attributes.type="hidden","<input "+dg.attributes(a._attributes)+" />"},dg.theme_number=function(a){return a._attributes.type="number","<input "+dg.attributes(a._attributes)+"/>"},dg.theme_password=function(a){return a._attributes.type="password","<input "+dg.attributes(a._attributes)+" />"},dg.theme_submit=function(a){a._attributes.type="submit";return!a._attributes.value&&a._value&&(a._attributes.value=a._value),"<input "+dg.attributes(a._attributes)+"/>"},dg.theme_textarea=function(a){var b=a._value?a._value:"";return"<textarea "+dg.attributes(a._attributes)+">"+b+"</textarea>"},dg.theme_textfield=function(a){return a._attributes.type="text","<input "+dg.attributes(a._attributes)+"/>"},dg.FormStateInterface=function(a){this.form=a,this.values={},this.errors={}},dg.FormStateInterface.prototype.get=function(a){return"undefined"!=typeof this[a]?this[a]:null},dg.FormStateInterface.prototype.set=function(a,b){this[a]=b},dg.FormStateInterface.prototype.setFormState=function(){var a=this,b=a.get("form"),c=[];for(var d in b.elements)"actions"!=d&&c.push(b.elements[d].valueCallback());return Promise.all(c).then(function(b){for(var c=0;c<b.length;c++)a.setValue(b[c].name,b[c].value)})},dg.FormStateInterface.prototype.setErrorByName=function(a,b){this.errors[a]=b},dg.FormStateInterface.prototype.getErrors=function(){return this.errors},dg.FormStateInterface.prototype.hasAnyErrors=function(){var a=!1,b=this.getErrors();for(error in b)if(b.hasOwnProperty(error)){a=!0;break}return a},dg.FormStateInterface.prototype.getErrorMessages=function(){var a="",b=this.getErrors();for(error in b)b.hasOwnProperty(error)&&(a+=error+" - "+b[error]);return a},dg.FormStateInterface.prototype.displayErrors=function(){dg.alert(this.getErrorMessages())},dg.FormStateInterface.prototype.getValue=function(a,b){return"undefined"!=typeof this.get("values")[a]?this.get("values")[a]:b},dg.FormStateInterface.prototype.setValue=function(a,b){this.values[a]=b},dg.FormStateInterface.prototype.getValues=function(){return this.get("values")},dg.FormStateInterface.prototype.setValues=function(a){this.values=a},dg.FormWidget=function(a,b,c,d,e,f){},dg.FormWidget.prototype=new dg.FormElement,dg.FormWidget.prototype.constructor=dg.FormWidget,dg.FormWidgetPrepare=function(a,b){a.widgetType="FormWidget",a.entityType=b[0],a.bundle=b[1],a.fieldName=b[2],a.name=a.fieldName,a.element=b[3],a.items=b[4],a.delta=b[5],a.fieldFormMode=a.element._fieldFormMode},dg.FormWidget.prototype.valueCallback=function(){var a=this;return new Promise(function(b,c){var d=null,e=document.getElementById(a.id());e&&(d=e.value),b({name:a.get("name"),value:[{value:d}]})})},dg.forms={},dg.Form=function(a){this.id=a,this.form={_attributes:{id:dg.killCamelCase(a,"-").toLowerCase()},_validate:[a+".validateForm"],_submit:[a+".submitForm"]},this.form_state=new dg.FormStateInterface(this),this.elements={}},dg.Form.prototype.getFormId=function(){return this.id},dg.Form.prototype.getForm=function(){var a=this;return new Promise(function(b,c){a.buildForm(a.form,a.form_state).then(function(){for(name in a.form)if(dg.isFormElement(name,a.form)){var c=a.form[name];if("actions"==c._type){dg.setFormElementDefaults(name,c);for(_name in c)dg.isFormElement(_name,c)&&dg.setFormElementDefaults(_name,c[_name])}else dg.setFormElementDefaults(name,c)}var d=jDrupal.moduleInvokeAll("form_alter",a.form,a.getFormState(),a.getFormId()),e=function(){for(var c in a.form)if(dg.isFormElement(c,a.form)){var d=a.form[c];switch(d._widgetType){case"FieldWidget":case"FormWidget":var e=a.form._entity.get(c),f=0;a.elements[c]=new dg.modules[d._module][d._widgetType][d._type](a.form._entityType,a.form._bundle,c,d,e,f),a.elements[c].form(e,f,d,a.form,a.form_state);break;case"FormElement":default:a.elements[c]=new dg[d._widgetType](c,d,a)}}b("<form "+dg.attributes(a.form._attributes)+">"+dg.render(a.form)+"</form>")};d?d.then(e):e()})})},dg.Form.prototype.getFormState=function(){return this.form_state},dg.Form.prototype.buildForm=function(a,b,c){return new Promise(function(a,b){a()})},dg.Form.prototype.validateForm=function(a){return new Promise(function(a,b){a()})},dg.Form.prototype.submitForm=function(a,b,c){return new Promise(function(a,b){a()})},dg.Form.prototype._submission=function(){var a=this;return new Promise(function(b,c){var d=a.getFormState();d.setFormState().then(function(){a._validateForm().then(function(){return d.hasAnyErrors()?(d.displayErrors(),void c()):void a._submitForm(a,d).then(function(){a.form._action&&dg["goto"](a.form._action),dg.removeForm(a.getFormId()),b()})})})})},dg.Form.prototype._validateForm=function(){for(var a=this,b=[],c=0;c<a.form._validate.length;c++){var d=a.form._validate[c].split("."),e=d[0],f=d[1];e!=this.getFormId()||"validateForm"!=f?window[e]&&window[e][f]&&b.push(window[e][f].apply(a,[a.form,a.getFormState()])):b.push(this[f].apply(a,[a.form,a.getFormState()]))}return Promise.all(b)},dg.Form.prototype._submitForm=function(){for(var a=this,b=[],c=0;c<a.form._submit.length;c++){var d=a.form._submit[c].split("."),e=d[0],f=d[1];e!=this.getFormId()||"submitForm"!=f?window[e]&&window[e][f]&&b.push(window[e][f].apply(a,[a.form,a.getFormState()])):b.push(this[f].apply(a,[a.form,a.getFormState()]))}return Promise.all(b)},dg.addForm=function(a,b){return this.forms[a]=b,this.forms[a]},dg.loadForm=function(a){return this.forms[a]?this.forms[a]:null},dg.loadForms=function(){return this.forms},dg.removeForm=function(a){delete this.forms[a]},dg.removeForms=function(){this.forms={}},dg.isFormElement=function(a,b){return b.hasOwnProperty(a)&&"_"!=a.charAt(0)},dg.isFormProperty=function(a,b){return b.hasOwnProperty(a)&&"_"==a.charAt(0)},dg.setFormElementDefaults=function(a,b){var c=b._attributes?b._attributes:{};c.id||(c.id="edit-"+a.toLowerCase().replace(/_/g,"-")),c.name||(c.name=a),c["class"]||(c["class"]=[]),!c.value&&b._value&&(c.value=b._value),b._widgetType||(b._widgetType="FormElement"),b._title_placeholder&&(c.placeholder=b._title),b._attributes=c},dg["goto"]=function(a){this.router.navigate(a)},dg.alert=function(a){var b=null;arguments[1]&&(b=arguments[1]);var c=function(){},d="Alert",e="OK";b&&(b.alertCallback&&(c=b.alertCallback),b.title&&(d=b.title),b.buttonName&&(e=b.buttonName)),"phonegap"!=dg.config("mode")||"undefined"==typeof navigator.notification?(alert(a),c()):navigator.notification.alert(a,c,d,e)},dg.modules=jDrupal.modules,dg.Module=function(){},dg.Module.prototype=new jDrupal.Module,dg.Module.prototype.constructor=dg.Module,dg.Module.prototype.routing=function(){return null},dg.Region=function(a){this.format="div";for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},dg.Region.prototype.get=function(a){return"undefined"!=typeof this[a]?this[a]:null},dg.Region.prototype.set=function(a,b){this[a]=b},dg.loadRegions=function(){},dg.Region.prototype.getBlocks=function(){var a=dg.blocksLoad(),b=[];for(var c in a)a.hasOwnProperty(c)&&a[c].get("region")==this.get("id")&&b.push(c);return b},dg.appRender=function(a){dg.themeLoad().then(function(b){var c="";dg.regions={};var d=b.getRegions();for(var e in d)if(d.hasOwnProperty(e)){var f={id:e,attributes:{id:e}},g=new dg.Region(f);for(var h in d[e])d[e].hasOwnProperty(h)&&g.set(h,d[e][h]);dg.regions[e]=g;var i=dg.regions[e].getBlocks();if(0!=i.length){c+="<"+g.get("format")+" "+dg.attributes(g.get("attributes"))+">";for(var j=0;j<i.length;j++){var k=dg.blockLoad(i[j]);c+="<"+k.get("format")+" "+dg.attributes(k.get("attributes"))+">",c+="</"+k.get("format")+">"}c+="</"+g.get("format")+">"}}c+=dg.render(a),document.getElementById("dg-app").innerHTML=c;var i=dg.blocksLoad(),l=[];for(e in i)i.hasOwnProperty(e)&&(l.push(e),i[e].buildWrapper().then(function(a){function b(a){a.preventDefault&&a.preventDefault();var b=dg.loadForm(d);return b._submission().then(function(){},function(){}),!1}if(document.getElementById(a.get("id")).innerHTML=dg.render(a.get("content")),l.splice(l.indexOf(a.get("id")),1),0==l.length){var c=dg.loadForms();for(var d in c)if(c.hasOwnProperty(d)){var e=dg.killCamelCase(d,"-"),f=document.getElementById(e);f.attachEvent?f.attachEvent("submit",b):f.addEventListener("submit",b)}}}))})},dg.render=function(a){try{var b=typeof a;if(!a)return"";if("string"===b)return a;var c="";if("object"===b){var d=a._prefix?a._prefix:"",e=a._suffix?a._suffix:"";if(a.markup&&(console.log('DEPRECATED: Use "_markup" instead of "markup" in this render array:'),console.log(a),a._markup=a.markup),a._markup)return d+a._markup+e;if(a._theme)return d+dg.theme(a._theme,a)+e;if(a._type)return d+dg.theme(a._type,a)+e;c+=d;for(var f in a)if(a.hasOwnProperty(f)&&"_prefix"!=f&&"_suffix"!=f){var g=a[f],h=typeof g;if("object"===h)c+=dg.render(g);else if("array"===h)for(var i=0;i<g.length;i++)c+=dg.render(g[i])}c+=e}else if("array"===b)for(var i=0;i<a.length;i++)c+=dg.render(a[i]);return c}catch(j){console.log("dg.render - "+j)}},dg.commentLoad=function(){return jDrupal.commentLoad.apply(jDrupal,arguments)},dg.nodeLoad=function(){return jDrupal.nodeLoad.apply(jDrupal,arguments)},dg.userLoad=function(){return jDrupal.userLoad.apply(jDrupal,arguments)},dg.token=function(){return jDrupal.token()},dg.restPath=function(){return jDrupal.restPath()},dg.router={routes:[],mode:null,root:"/",config:function(a){return this.mode=a&&a.mode&&"history"==a.mode&&history.pushState?"history":"hash",this.root=a&&a.root?"/"+this.clearSlashes(a.root)+"/":"/",this},getFragment:function(){var a="";if("history"===this.mode)a=this.clearSlashes(decodeURI(location.pathname+location.search)),a=a.replace(/\?(.*)$/,""),a="/"!=this.root?a.replace(this.root,""):a;else{var b=window.location.href.match(/#(.*)$/);a=b?b[1]:""}return this.clearSlashes(a)},prepFragment:function(a){var b=a||this.getFragment();return this.root+b},clearSlashes:function(a){return a.toString().replace(/\/$/,"").replace(/^\//,"")},add:function(a){return this.routes.push(a),this},remove:function(a){for(var b,c=0;c<this.routes.length,b=this.routes[c];c++)if(b.path.toString()===a.toString())return this.routes.splice(c,1),this;return this},flush:function(){return this.routes=[],this.mode=null,this.root="/",this},check:function(a){var b=this.load(a);if(b){dg.removeForms();var c=this.matches(a).match,d=function(a){dg.content=a,dg.appRender()};if(b.defaults||(b=this.load(dg.config("front"))),b.defaults)if(b.defaults._form){var e=b.defaults._form;c.length>1?(c.shift(),dg.addForm(e,dg.applyToConstructor(window[e],c)).getForm().then(d)):dg.addForm(e,new window[e]).getForm().then(d)}else c.length>1?(c.shift(),b.defaults._controller.apply(null,c).then(d)):b.defaults._controller().then(d)}return this},listen:function(){var a=this,b=a.getFragment(),c=function(){b!==a.getFragment()&&(b=a.getFragment(),a.check(b))};return clearInterval(this.interval),this.interval=setInterval(c,50),this},load:function(a){var b=this.matches(a);return b?this.routes[b.i]:null},matches:function(a){for(var b=this.prepFragment(a),c=0;c<this.routes.length;c++){var d=b.match(this.routes[c].path);if(d)return{match:d,i:c}}return null},navigate:function(a){if(a=a?a:"","history"===this.mode){var b=this.root+this.clearSlashes(a);history.pushState(null,null,b)}else window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+a;return this},getRoutes:function(){return this.routes},getRoute:function(){}},dg.Theme=function(){this.regions=null},dg.Theme.prototype.get=function(a){return"undefined"!=typeof this[a]?this[a]:null},dg.Theme.prototype.getRegions=function(){return this.get("regions")},dg.themeLoad=function(){return new Promise(function(a,b){if(!dg.activeTheme){var c=dg.config("theme"),d=jDrupal.ucfirst(dg.getCamelCase(c.name));dg.activeTheme=new window[d]}a(dg.activeTheme)})},dg.theme=function(a,b){try{if(b||(b={}),b._markup)return b._markup;var c="",d="theme_"+a;if(!jDrupal.functionExists(dg[d])){var e=null;arguments.callee.caller&&(e=arguments.callee.caller.name);var f="WARNING: "+d+"() does not exist.";return e&&(f+=" Called by: "+e+"()."),console.log(f),c}b._attributes||(b._attributes={}),b._attributes["class"]||(b._attributes["class"]=[]);var g=dg[d].call(null,b);return g instanceof Promise?(g.then(function(a){document.getElementById(a.variables._attributes.id).innerHTML=dg.render(a.content)}),"<div "+dg.attributes(b._attributes)+"></div>"):g}catch(h){console.log("dg.theme - "+h)}},dg.currentUser=function(){return jDrupal.currentUser()},dg.userPassword=function(){return jDrupal.userPassword.apply(jDrupal,arguments)},dg.theme_view=function(a){if(!a._attributes.id){var b="WARNING: dg.theme_view - no attribute id was provided, so a random one was generated for the following View widget: "+dg.restPath()+a._path;console.log(b),a._attributes.id=dg.userPassword()}return new Promise(function(b){jDrupal.viewsLoad(a._path).then(function(c){var d=a._format?a._format:"div",e=a._format_attributes?a._format_attributes:null,f="<"+d+" "+dg.attributes(e)+">";if(c.results.length>0)for(var g=0;g<c.results.length;g++){var h,i="";switch(d){case"ul":case"ol":h="<li>",i="</li>";break;case"table":h="<tr>",i="</tr>"}f+=h+a._row_callback(c.results[g])+i}f+="</"+d+">",b({variables:a,content:f})})})},dg.l=function(a,b,c){return c||(c={}),c._text||(c._text=a),c._path||(c._path=b),dg.theme("link",c)},dg.theme_link=function(a){var b=a._text?a._text:"";return"undefined"==typeof a._attributes.href&&a._path&&(a._attributes.href="#"+a._path),"<a "+dg.attributes(a._attributes)+">"+b+"</a>"},dg.theme_item_list=function(a){var b="",c=a._type?a._type:"ul";if(a._title&&(b+="<h2>"+a._title+"</h2>"),b+="<"+c+" "+dg.attributes(a._attributes)+">",a._items&&a._items.length>0)for(var d in a._items)if(a._items.hasOwnProperty(d)){var e=a._items[d];b+="<li>"+e+"</li>"}return b+="</"+c+">"},dg.modules.core=new dg.Module,dg.modules.core.FieldWidget={},dg.modules.core.FieldWidget.integer=function(a,b,c,d,e,f){dg.FieldWidgetPrepare(this,arguments)},dg.modules.core.FieldWidget.integer.prototype=new dg.FieldWidget,dg.modules.core.FieldWidget.integer.prototype.constructor=dg.modules.core.FieldWidget.integer,dg.modules.core.FieldWidget.integer.prototype.form=function(a,b,c,d,e){c._type="number",c._title=this.fieldDefinition.getLabel(),c._title_placeholder=!0,c._widgetType="FieldWidget",c._module="core",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FieldWidget.string=function(a,b,c,d,e,f){dg.FieldWidgetPrepare(this,arguments)},dg.modules.core.FieldWidget.string.prototype=new dg.FieldWidget,dg.modules.core.FieldWidget.string.prototype.constructor=dg.modules.core.FieldWidget.string,dg.modules.core.FieldWidget.string.prototype.form=function(a,b,c,d,e){c._type="textfield",c._title=this.fieldDefinition.getLabel(),c._title_placeholder=!0,c._widgetType="FieldWidget",c._module="core",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FormWidget={},dg.modules.core.FormWidget.string_textfield=function(a,b,c,d,e,f){dg.FormWidgetPrepare(this,arguments)},dg.modules.core.FormWidget.string_textfield.prototype=new dg.FormWidget,dg.modules.core.FormWidget.string_textfield.prototype.constructor=dg.modules.core.FormWidget.string_textfield,dg.modules.core.FormWidget.string_textfield.prototype.form=function(a,b,c,d,e){c._type="textfield",c._title=this.fieldName,c._title_placeholder=!0,c._widgetType="FormWidget",c._module="core",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FormWidget.bundle=function(a,b,c,d,e,f){dg.FormWidgetPrepare(this,arguments)},dg.modules.core.FormWidget.bundle.prototype=new dg.FormWidget,dg.modules.core.FormWidget.bundle.prototype.constructor=dg.modules.core.FormWidget.bundle,dg.modules.core.FormWidget.bundle.prototype.form=function(a,b,c,d,e){c._type="hidden",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.core.FormWidget.bundle.prototype.valueCallback=function(a,b,c){var d=new(dg[jDrupal.ucfirst(this.get("entityType"))])(null);return{name:d.getEntityKey("bundle"),value:[{target_id:this.get("bundle")}]}},dg.modules.core.FormWidget.entityID=function(a,b,c,d,e,f){dg.FormWidgetPrepare(this,arguments)},dg.modules.core.FormWidget.entityID.prototype=new dg.FormWidget,dg.modules.core.FormWidget.entityID.prototype.constructor=dg.modules.core.FormWidget.entityID,dg.modules.core.FormWidget.entityID.prototype.form=function(a,b,c,d,e){c._type="hidden",a&&"undefined"!==a[b]&&(c._value=a[b].value,c._attributes.value=c._value)},dg.modules.image=new dg.Module;var NodeEdit=function(){this.entity=null,this.entityType="node",this.bundle=null,this.entityID=null,arguments[0]&&(jDrupal.isInt(arguments[0])?this.entityID=arguments[0]:(this.entity=new(dg[jDrupal.ucfirst(this.entityType)])(null),this.bundle=arguments[0]));var a=this;this.buildForm=function(b,c){return new Promise(function(c,d){var e=function(){var d=a.entityType,e=a.bundle,f=a.entity,g=dg.entity_form_mode[d][e];b._entity=f,b._entityType=d,b._bundle=e,b[f.getEntityKey("bundle")]={_type:"bundle",_widgetType:"FormWidget",_module:"core",_entityType:d,_bundle:e,_value:e};for(var h in g)if(g.hasOwnProperty(h)){var i=dg.fieldStorageConfig[d][h];if(i){var j=i.module;if(!j)continue;if(!jDrupal.moduleExists(j)){console.log('WARNING - buildForm - The "'+j+'" module is not present for the widget on the "'+h+'" field.');continue}if(!dg.modules[j].FieldWidget||!dg.modules[j].FieldWidget[i.type]){console.log('WARNING - buildForm - There is no "'+i.type+'" widget in the "'+j+'" module to handle the "'+h+'" field.');continue}b[h]={_type:i.type,_widgetType:"FieldWidget",_module:j,_entityType:d,_bundle:e,_fieldName:h,_fieldFormMode:new dg.FieldFormMode(g[h])}}else{var k=g[h].type;if(!dg.modules.core.FormWidget[k]){console.log('WARNING - buildForm - There is no "'+k+'" widget in the core module to handle the "'+h+'" element.');continue}b[h]={_type:k,_widgetType:"FormWidget",_module:"core",_entityType:d,_bundle:e,_fieldName:h,_fieldFormMode:new dg.FieldFormMode(g[h])}}}b.actions={_type:"actions",submit:{_type:"submit",_value:"Save",_button_type:"primary"}},c(b)};a.entityID?dg.nodeLoad(a.entityID).then(function(c){a.entity=c,a.bundle=c.getBundle(),b[c.getEntityKey("id")]={_type:"entityID",_widgetType:"FormWidget",_module:"core",_value:a.entityID},e()}):e()})},this.submitForm=function(a,b){return new Promise(function(c,d){var e=new(jDrupal[jDrupal.ucfirst(a._entityType)])(b.getValues());e.save().then(function(){a._action||(a._action=a._entityType+"/"+e.id()),c()})})}};NodeEdit.prototype=new dg.Form("NodeEdit"),NodeEdit.constructor=NodeEdit,dg.modules.node=new dg.Module,dg.modules.node.routing=function(){var a={};return a["node.add.type"]={path:"/node/add/(.*)",defaults:{_form:"NodeEdit",_title:"Create content"}},a["node.add"]={path:"/node/add",defaults:{_controller:function(){return new Promise(function(a,b){var c=[];for(var d in dg.allBundleInfo.node)dg.allBundleInfo.node.hasOwnProperty(d)&&c.push(dg.l(dg.allBundleInfo.node[d].label,"node/add/"+d));var e={};e.types={_theme:"item_list",_items:c},a(e)})},_title:"Create content"}},a["node.edit"]={path:"/node/(.*)/edit",defaults:{_form:"NodeEdit",_title:"Node edit"}},a.node={path:"/node/(.*)",defaults:{_controller:function(a){return new Promise(function(b,c){dg.nodeLoad(a).then(function(a){dg.entityRenderContent(a).then(b)})})},_title:"Node"}},a},dg.modules.system=new dg.Module,dg.modules.system.blocks=function(){var a={};return a.main={build:function(){return new Promise(function(a,b){a(dg.content)})}},a},dg.modules.text=new dg.Module,dg.modules.text=new dg.Module,dg.modules.text.FieldFormatter={},dg.modules.text.FieldFormatter.text_default=function(){dg.FieldFormatterPrepare(this,arguments)},dg.modules.text.FieldFormatter.text_default.prototype=new dg.FieldFormatter,dg.modules.text.FieldFormatter.text_default.prototype.constructor=dg.modules.text.FieldFormatter.text_default,dg.modules.text.FieldFormatter.text_default.prototype.viewElements=function(a,b){var c=a.getItems(),d={};if(0==c.length)return d;for(var e=0;e<c.length;e++)d[e]={_markup:c[e].value};return d},dg.modules.text.FieldWidget={},dg.modules.text.FieldWidget.text_with_summary=function(a,b,c,d,e,f){dg.FieldWidgetPrepare(this,arguments)},dg.modules.text.FieldWidget.text_with_summary.prototype=new dg.FieldWidget,dg.modules.text.FieldWidget.text_with_summary.prototype.constructor=dg.modules.text.FieldWidget.text_with_summary,dg.modules.text.FieldWidget.text_with_summary.prototype.form=function(a,b,c,d,e){c._type="textarea",c._title=this.fieldDefinition.getLabel(),c._title_placeholder=!0,c._widgetType="FieldWidget",c._module="text",a&&"undefined"!==a[b]&&(c._value=a[b].value)};var UserLoginForm=function(){this.buildForm=function(a,b){return new Promise(function(b,c){a._action=dg.config("front"),a.name={_type:"textfield",_title:"Username",_required:!0,_title_placeholder:!0},a.pass={_type:"password",_title:"Password",_required:!0,_title_placeholder:!0},a.actions={_type:"actions",submit:{_type:"submit",_value:"Log in",_button_type:"primary"}},b(a)})},this.submitForm=function(a,b){return new Promise(function(a,c){jDrupal.userLogin(b.getValue("name"),b.getValue("pass")).then(a)})}};UserLoginForm.prototype=new dg.Form("UserLoginForm"),UserLoginForm.constructor=UserLoginForm,dg.modules.user=new dg.Module,dg.modules.user.routing=function(){var a={};return a["user.login"]={path:"/user/login",defaults:{_form:"UserLoginForm",_title:"Log in"}},a["user.logout"]={path:"/user/logout",defaults:{_title:"Log out",_controller:function(){return new Promise(function(a,b){a("Logging out..."),jDrupal.userLogout().then(function(){dg["goto"](dg.config("front"))})})}}},a.user={path:"/user/(.*)",defaults:{_controller:function(a){return new Promise(function(b,c){dg.userLoad(a).then(function(a){dg.entityRenderContent(a).then(b)})})},_title:"user"}},a};